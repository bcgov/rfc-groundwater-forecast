---
output:
  pdf_document:
    includes:
      in_header: well_report.tex
    latex_engine: xelatex
    pandoc_args: ["--variable=geometry:paperwidth=8.5in,paperheight=8in,margin=0.25in"]
params:
  well_id: NULL
  well_location: NULL
  well_tag_number: NULL
  aquifer_num: NULL
  aquifer_type: NULL
  model_type: NULL
  latest_date: NULL
  start_year: NULL
  table: NULL
header-includes:
  - \usepackage{multicol}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(gt)
```

\vspace*{-1.5cm}

\begin{center}
{\large \textbf{Observation Well `r paste0(params$well_id, " - ", gsub("&", "\\\\&", params$well_location))`}}
\vspace{-1.2em}
\end{center}

\begin{center}
\textbf{`r params$aquifer_type` Aquifer | Data since `r params$start_year`| Latest on `r format(params$latest_date, "%b-%d")` | Forecast issued: `r format(Sys.Date(), "%b-%d")`}
\vspace{-1.5em}
\end{center}

\begin{center}
\begin{minipage}[t]{0.48\textwidth}
\centering
\includegraphics[width=8in]{Well_`r params$well_id`_plot.pdf}
\end{minipage}%
\hfill
\begin{minipage}[t]{0.48\textwidth}
\centering
\end{minipage}
\end{center}

\begin{center}
{\large \textbf{`r paste0(params$well_id)` - Likelihood (\%) of Groundwater Level Conditions}}
\vspace{-1.5em}
\end{center}

```{r table}
params$table %>% 
  tab_options(latex.use_longtable=TRUE,
              table.font.size = px(12))
```

\begin{wrapfigure}{r}{0.4\textwidth}
  \centering
  \vspace{-10pt}
  \vspace{-10pt}
\end{wrapfigure}

\footnotesize 
\begin{multicols}{2}

\textbf{Model Description}: The model uses artificial neural networks, a type of machine learning, to relate groundwater levels to historic precipitation, temperature, and, for some wells, snowpack data. The model also accounts for recharge lag times, capturing how groundwater responds to hydroclimate data. Forecasts provide a range of likely conditions and are presented as likelihoods of groundwater being above, below, or near normal. This anal-

\columnbreak
ysis uses the “normal” term solely in reference to water levels between the 25th to 75th percentiles of historical data, not to imply a steady state baseline for comparison. Data should be interpreted with the context of long-term data records, patterns, and trends.

\textbf{Disclaimer}: Groundwater level forecasts use statistical models and third-party data. These models have two types of errors: systematic (model limitations) and random (input data). Forecasts may differ from actual observations, and water levels could exceed forecast bounds. Users must accept responsibility for their use and interpretation.

\end{multicols}

\begin{center}
{\small Model Information: \textcolor{blue}{\href{https://www2.gov.bc.ca/gov/content/environment/air-land-water/water/drought-flooding-dikes-dams/river-forecast-centre}{Detailed explanation of chart}} | \textcolor{blue}{\href{https://www2.gov.bc.ca/gov/content/environment/air-land-water/water/drought-flooding-dikes-dams/river-forecast-centre}{Technical reference for model}} | \textcolor{blue}{\href{https://nrs.objectstore.gov.bc.ca/rfc-conditions/groundwater_forecast/outputs/Groundwater_Drought_Forecast_Map.html}{Forecast Map}}\\

Well Information: \textcolor{blue}{\href{`r paste0("https://aqrt.nrs.gov.bc.ca/Data/Location/Summary/Location/",params$well_id,"/Interval/Latest")`}{Real-time Data}} | \textcolor{blue}{\href{`r paste0("https://bcrfc.env.gov.bc.ca/Real-time_Data/Interactive_Q_process/InteractivePlots/groundwater_levels/",params$well_id,"_dailyWL.html")`}{Interactive hydrograph}} | \textcolor{blue}{\href{`r paste0("https://apps.nrs.gov.bc.ca/gwells/well/", params$well_tag_number)`}{Well summary}} | \textcolor{blue}{\href{`r paste0("https://apps.nrs.gov.bc.ca/gwells/aquifers/",params$aquifer_num)`}{Aquifer summary}} | \textcolor{blue}{\href{https://www2.gov.bc.ca/gov/content/environment/air-land-water/water/groundwater-wells-aquifers/groundwater-observation-well-network}{PGOWN}}
}

Issued by \textcolor{blue}{\href{https://www2.gov.bc.ca/gov/content/environment/air-land-water/water/drought-flooding-dikes-dams/river-forecast-centre}{BC River Forecast Centre}} | Updated: `r format(Sys.time(), "%Y-%m-%d %H:%M")`

\end{center}

